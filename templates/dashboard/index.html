{% extends "base.html" %}

{% block content %}
    <h1>Your Dashboard</h1>

    <div class="dashboard-grid">
        
        <div>
            <section>
                <h2>Create New Task</h2>
                <form method="post">
                    {% csrf_token %}
                    {{ task_form.as_p }}
                    <button type="submit" name="submit_task">Save Task</button>
                </form>
            </section>
            
            <section>
                <h2>Create New Note</h2>
                <form method="post" enctype="multipart/form-data">
                    {% csrf_token %}
                    {{ note_form.as_p }}
                    <button type="submit" name="submit_note">Save Note</button>
                </form>
            </section>
        </div>

        <div>
            <section>
                <h2>Your Tasks</h2>
                <ul>
                    {% for task in tasks %}
                        <li>
                            <span{% if task.completed %} style="text-decoration: line-through; color: #888;"{% endif %}>
                                {{ task.title }}
                            </span>
                            
                            <div class="task-actions">
                                <form method="POST" action="{% url 'task_toggle' task.pk %}" class="form-inline">
                                    {% csrf_token %}
                                    <button type="submit" class="button btn-small">
                                        {% if task.completed %}Undo{% else %}Done{% endif %}
                                    </button>
                                </form>
                                
                                <a href="{% url 'task_edit' task.pk %}" class="button btn-small btn-edit">Edit</a>
                                
                                <form method="POST" action="{% url 'task_delete' task.pk %}" class="form-inline">
                                    {% csrf_token %}
                                    <button type="submit" class="button btn-small btn-delete">Delete</button>
                                </form>
                            </div>
                        </li>
                    {% empty %}
                        <li>No tasks found.</li>
                    {% endfor %}
                </ul>
            </section>

            <section>
                <h2>Your Notes</h2>
                <ul>
                    {% for note in notes %}
                        <li>
                            <span>
                                {{ note.title }}
                                {% if note.task %}
                                <small style="color: #888;">(Task: {{ note.task.title }})</small>
                                {% endif %}
                            </span>
                            {% if note.file %}
                                <a href="{{ note.file.url }}" target="_blank">View File</a>
                            {% endif %}
                        </li>
                    {% empty %}
                        <li>No notes found.</li>
                    {% endfor %}
                </ul>
            </section>
        </div>
    </div>
{% endblock %}